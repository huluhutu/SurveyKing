(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[8068],{68068:function(ae,U,u){"use strict";u.d(U,{O:function(){return re},Z:function(){return Fe}});var L=u(9761),V=u(67294),G=u(67635),H=u(86052),K=u(48187),Y=u(91220),k=u(93224),F=u(39428),D=u(83279),Z=u(3182),b=u(11849),ee=u(94657),se=u(69610),ue=u(54941),q=u(3980),I=u(64031),g=u(54531);function le(l,t){}var M=u(40807),oe=["visible"],de=function(){function l(t){var r=this;(0,se.Z)(this,l),this.props=void 0,this.progress=0,this.form=void 0,this.pagination={current:1,pageSize:1,currentIndex:0,paginationNodes:[]},this.notNoneInQuestionGroup=[],this.answerSheet=[],this.answerSheetVisible=!1,this.reviewAnswer={},this.autoNextPage=void 0,this.compute=void 0,this.hiddenOption={};var i=t.initialValues,n=t.readOnly,e=t.fieldPermission,a=t.theme,s=t.schema,o=t.mode,d=t.onePageOneQuestion,f=d===void 0?!1:d,v=t.paginationVisible;this.props=t,this.initPagination(s,v,f);var p=(0,I.Np)({initialValues:i,readOnly:n,validateFirst:!0,pattern:t.pattern,effects:function(y){(0,I.dQ)(function(){if(e){var m=[],c=[];Object.entries(e).forEach(function(x){var $=(0,ee.Z)(x,2),O=$[0],A=$[1];A===0?m.push(O):A===1&&c.push(O)}),m.length>0&&p.setFieldState("*(".concat(m.join(","),")"),function(x){return x.display="none"}),c.length>0&&p.setFieldState("*(".concat(c.join(","),")"),function(x){return x.pattern="readPretty"})}r.handleFormValuesChange(),r.highlightJs(),r.setVisible(0)}),(0,I.pO)(function(m){r.handleFormValuesChange()}),(0,I.Zj)("*",function(m,c){r.handleFieldValueChange(m,c)}),le(s,y)}});this.form=p,this.answerSheet=(0,M.Xn)(s).filter(function(h){var y;return(0,M.a1)(h.type)&&((y=h.attribute)===null||y===void 0?void 0:y.display)!=="hidden"}).map(function(h){return{finished:!1,id:h.id,marked:!1,display:"visible",favorite:!!t.wrongMode}})||[],a==="antd"&&o==="exam"&&(this.answerSheetVisible=!0),this.autoNextPage=0,t.exerciseMode&&t.onePageOneQuestion&&(this.autoNextPage=1),this.makeObservable(),this.props.correctAnswerVisible&&i&&(0,M.Xn)(s).forEach(function(h){r.computeReviewAnswer(h,i[h.id]).then(function(y){y&&(r.reviewAnswer[h.id].visible=!0)})}),this.compute=fe(function(){r.reOrder(),r.computeProgress(),r.computePagination()},10)}return(0,ue.Z)(l,[{key:"makeObservable",value:function(){(0,g.Ou)(this,{progress:g.LO.ref,pagination:g.LO.shallow,form:g.LO.ref,props:g.LO.shallow,answerSheet:g.LO,answerSheetVisible:g.LO.ref,reviewAnswer:g.LO,notNoneInQuestionGroup:g.LO,schema:g.LO.computed,autoNextPage:g.LO.ref,hiddenOption:g.LO.shallow,exerciseMode:g.LO.computed,computeProgress:g.aD,validate:g.aD,handlePrev:g.aD,handleNext:g.aD,submit:g.aD,handleFormValuesChange:g.aD,changePageIndex:g.aD,handleFieldValueChange:g.aD,computeReviewAnswer:g.aD,reOrder:g.aD})}},{key:"schema",get:function(){return this.props.schema}},{key:"questionsGroupByPagination",get:function(){return this.pagination.paginationNodes}},{key:"exerciseMode",get:function(){return this.props.exerciseMode||!1}},{key:"initPagination",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;i?this.pagination.paginationNodes=(0,M._T)(r,n):this.pagination.paginationNodes=[r.children],this.pagination.pageSize=this.pagination.paginationNodes.length}},{key:"computePagination",value:function(){if(this.props.paginationVisible===!1)return;var r=this.form.fields;function i(v){return e[v].every(function(p){var h=r[p.id].data;return h.some(function(y){return y==="self_display"||y.startsWith("rule_")})})}for(var n=this.pagination,e=n.paginationNodes,a=n.currentIndex,s=0,o=0,d=0;d<e.length;d++){var f=e[d];if(f.some(function(v){var p=r[v.id].data;return p.length===0}))o++,s++;else{if(i(d))continue;o++,d<=a&&s++}}this.pagination=(0,b.Z)((0,b.Z)({},this.pagination),{},{current:s,pageSize:o,currentIndex:a})}},{key:"highlightJs",value:function(){document.querySelectorAll(".ql-syntax").forEach(function(r){})}},{key:"validate",value:function(){var t=(0,Z.Z)((0,F.Z)().mark(function i(n){var e,a;return(0,F.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(a=((e=this.questionsGroupByPagination[n])===null||e===void 0?void 0:e.reduce(function(d,f){return d.push.apply(d,(0,D.Z)((0,M.Xn)(f))),d},[]))||[],a.length!==0){o.next=3;break}return o.abrupt("return",!0);case 3:return o.abrupt("return",this.form.validate("*(".concat(a.map(function(d){return d.id}).join(","),")")));case 4:case"end":return o.stop()}},i,this)}));function r(i){return t.apply(this,arguments)}return r}()},{key:"setVisible",value:function(r){if(this.props.paginationVisible===!1)return!1;var i=this.pagination,n=i.currentIndex,e=i.paginationNodes,a=this.form.fields,s=r===void 0?n:r;function o(h){return e[h].every(function(y){var m=a[y.id].data;return m.some(function(c){return c==="self_display"||c.startsWith("rule_")})})}if(r!==void 0){if(r===n+1){var d=o(r);if(d){this.pagination.currentIndex=n+1,this.setVisible(r+1);return}}else if(r===n-1){var f=o(r);if(f){this.pagination.currentIndex=n-1,this.setVisible(r-1);return}}}for(var v=0;v<e.length;v++){var p=e[v];v===s?p==null||p.forEach(function(h){var y=a[h.id].data;a[h.id].data=y.filter(function(m){return m!=="hidden"})}):p.forEach(function(h){var y=a[h.id].data;y.includes("hidden")||(a[h.id].data=[].concat((0,D.Z)(y),["hidden"]))})}this.pagination.currentIndex=s}},{key:"handlePrev",value:function(){var r=this.pagination.currentIndex;this.setVisible(r-1)}},{key:"handleNext",value:function(){var t=(0,Z.Z)((0,F.Z)().mark(function i(n){var e;return(0,F.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e=this.pagination.currentIndex,s.prev=1,s.next=4,this.validate(e);case 4:this.setVisible(e+1),setTimeout(function(){return window.scroll({top:0})},10),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(1),console.log(s.t0);case 11:case"end":return s.stop()}},i,this,[[1,8]])}));function r(i){return t.apply(this,arguments)}return r}()},{key:"changePageIndex",value:function(r){var i=this.questionsGroupByPagination.findIndex(function(n){return!!(n.reduce(function(e,a){return e.push.apply(e,(0,D.Z)((0,M.Xn)(a))),e},[])||[]).find(function(e){return e.id===r})});this.setVisible(i),(0,M.lA)(r,this.props.progressBar?-25:0)}},{key:"handleFormValuesChange",value:function(){var t=(0,Z.Z)((0,F.Z)().mark(function i(){return(0,F.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.computeProgress(),this.props.onChange&&this.props.onChange(this.form.values,this.progress);case 2:case"end":return e.stop()}},i,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"handleFieldValueChange",value:function(){var t=(0,Z.Z)((0,F.Z)().mark(function i(n,e){var a,s,o;return(0,F.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:o=n.path.toString(),(a=(s=this.props).onFieldChange)===null||a===void 0||a.call(s,o,(0,g.ZN)(n.value)),this.props.exerciseMode&&this.computeReviewAnswer(n.componentProps.schema,n.value);case 3:case"end":return f.stop()}},i,this)}));function r(i,n){return t.apply(this,arguments)}return r}()},{key:"computeReviewAnswer",value:function(){var t=(0,Z.Z)((0,F.Z)().mark(function i(n,e){var a,s,o,d,f,v,p,h;return(0,F.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(a=!1,this.props.mode!=="exam"){m.next=12;break}if(o=this.reviewAnswer[n.id]||{},d=n.type,["FillBlank","MultipleBlank","HorzBlank","Radio","Checkbox"].includes(n.type)){m.next=6;break}return m.abrupt("return");case 6:if(d==="Radio"&&(o.visible=!0),(s=n.attribute)!==null&&s!==void 0&&s.examAnswerMode&&["selectAll","selectCorrect","onlyOne","select"].includes(n.attribute.examAnswerMode)){m.next=9;break}return m.abrupt("return");case 9:a=!0,this.reviewAnswer[n.id]=n.children.reduce(function(c,x){var $,O=!!(($=x.attribute)!==null&&$!==void 0&&$.examCorrectAnswer);if(d==="FillBlank"||d==="MultipleBlank"||d==="Textarea"||d==="HorzBlank"){var A,R,J=(A=x.attribute)===null||A===void 0?void 0:A.examMatchRule,z=e==null?void 0:e[x.id],Q=(R=x.attribute)===null||R===void 0?void 0:R.examCorrectAnswer;!z||!Q?O=!1:J==="contain"&&z.includes(Q.trim())||z===Q?O=!0:O=!1}return c[x.id]={selected:!!(e!=null&&e.hasOwnProperty(x.id)),isCorrect:O},c},{visible:!!(o!=null&&o.visible)}),this.autoNextPage===1&&(f=this.reviewAnswer[n.id],v=f.visible,p=(0,k.Z)(f,oe),h=Object.values(p).filter(function(c){return c.selected&&c.isCorrect}).length===1,h&&d==="Radio"&&this.handleNext());case 12:return m.abrupt("return",a);case 13:case"end":return m.stop()}},i,this)}));function r(i,n){return t.apply(this,arguments)}return r}()},{key:"computeProgress",value:function(){var r=this;if(!!this.props.progressBar){var i=0,n=0;this.form.query("*").forEach(function(e){var a=r.answerSheet.find(function(s){return s.id===e.path.toString()});e.displayName==="Field"&&!e.path.toString().startsWith("_")&&(a&&(a.display=e.display),e.data.filter(function(s){return s!=="hidden"}).length===0&&i++,!(0,M.xb)(e.value)&&e.componentProps.schema.attribute.display!=="hidden"?(n++,a&&(a.finished=!0)):a&&(a.finished=!1))}),this.progress=n/i}}},{key:"reOrder",value:function(){var r,i=this;if(!!this.props.questionNumber){var n=1;(r=this.schema.children)===null||r===void 0||r.filter(function(e){return!(0,M.nj)(e.type)||e.type==="QuestionSet"}).forEach(function(e){var a,s=e.id,o=i.form.query(s).get("display");if(o!=="none"&&((a=e.attribute)===null||a===void 0?void 0:a.display)!=="hidden"){var d=i.form.query(s).take();d&&(d.setDecoratorProps((0,b.Z)((0,b.Z)({},d.decoratorProps),{},{seqNo:n})),n++);var f=1;if(e.type==="QuestionSet"){var v;(v=e.children)===null||v===void 0||v.filter(function(p){return!(0,M.nj)(p.type)}).forEach(function(p){var h=p.id,y=i.form.query(h).get("display");if(y==="visible"){var m=i.form.query(h).take();m&&(m.setDecoratorProps((0,b.Z)((0,b.Z)({},m.decoratorProps),{},{seqNo:f})),f++)}})}}})}}},{key:"submit",value:function(){var t=(0,Z.Z)((0,F.Z)().mark(function i(){var n,e,a,s,o,d,f,v,p,h,y;return(0,F.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:n="",e=this.form.query("*").map().filter(function(x){return!(0,I.JF)(x)}),a=(0,Y.Z)(e),c.prev=3,a.s();case 5:if((s=a.n()).done){c.next=31;break}if(v=s.value,!(0,I.JF)(v)){c.next=9;break}return c.abrupt("continue",29);case 9:if(n=v.path.toString(),p=((o=this.props.schema.children)===null||o===void 0||(d=o.find(function(x){return x.id===n}))===null||d===void 0||(f=d.attribute)===null||f===void 0?void 0:f.display)==="hidden",!p){c.next=13;break}return c.abrupt("continue",29);case 13:if(h=v.display,h!=="none"){c.next=16;break}return c.abrupt("continue",29);case 16:return y=v.selfDisplay,v.display="visible",c.prev=18,c.next=21,v.validate();case 21:v.display=y,c.next=29;break;case 24:return c.prev=24,c.t0=c.catch(18),this.changePageIndex(n),(0,M.lA)(n,this.props.progressBar?-25:0),c.abrupt("return");case 29:c.next=5;break;case 31:c.next=36;break;case 33:c.prev=33,c.t1=c.catch(3),a.e(c.t1);case 36:return c.prev=36,a.f(),c.finish(36);case 39:return this.props.onSubmit&&this.props.onSubmit((0,g.ZN)(this.form.values)),c.abrupt("return",{values:(0,g.ZN)(this.form.values)});case 41:case"end":return c.stop()}},i,this,[[3,33,36,39],[18,24]])}));function r(){return t.apply(this,arguments)}return r}()},{key:"markQuestion",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this.answerSheet,e=n.findIndex(function(a){return a.id===r});this.answerSheet.splice(e,1,(0,b.Z)((0,b.Z)({},n[e]),{},{marked:i}))}},{key:"favoriteQuestion",value:function(r){var i=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,e=this.answerSheet,a=e.findIndex(function(s){return s.id===r.templateId});n?q.hi.createUserBook((0,b.Z)((0,b.Z)({},r),{},{type:2})).then(function(s){s.success&&i.answerSheet.splice(a,1,(0,b.Z)((0,b.Z)({},e[a]),{},{favorite:n}))}):q.hi.deleteUserBook((0,b.Z)((0,b.Z)({},r),{},{type:2})).then(function(s){s.success&&i.answerSheet.splice(a,1,(0,b.Z)((0,b.Z)({},e[a]),{},{favorite:n}))})}}]),l}();function fe(l,t,r){var i=void 0,n=void 0;return function(){var e=+new Date;n||(n=e),r&&e-n>r?(l(),n=e,window.clearTimeout(i)):(window.clearTimeout(i),i=window.setTimeout(function(){l(),n=void 0},t))}}var ce=u(76826),te=u(99439),he=u(27484),ve=u.n(he),me=u(90019),X=u(10192);function ge(l,t){var r,i,n=t.id,e=[];if((r=t.parent)!==null&&r!==void 0&&(i=r.type)!==null&&i!==void 0&&i.startsWith("Matrix"))if(t.parent.type==="MatrixAuto"&&Array.isArray(l))l.forEach(function(d,f){e.push(["".concat(f,"-").concat(n),d[t.id]])});else{var a;(a=t.parent.row)===null||a===void 0||a.forEach(function(d){l[d.id]?e.push(["".concat(d.id,"-").concat(n),l[d.id][t.id]]):e.push(["".concat(d.id,"-").concat(n),void 0])})}else{var s,o=(s=t.parent)===null||s===void 0?void 0:s.type;o==="Radio"||o==="Checkbox"?Object.keys(l).includes(t.id)&&e.push([t.id,l[t.id]]):e.push([t.id,l[t.id]])}return e}function ne(l){return!isNaN(parseFloat(l))&&isFinite(l)}function pe(l){return!!(ne(l)&&Number.isInteger(parseFloat(l)))}function N(l){var t=l.errMsg,r=l.schema,i=l.regEx,n=l.value;return r?E({schema:r,value:n,errMsg:t,isValid:function(a){return a?i.test("".concat(a)):!0}}):null}function ye(l){var t,r=l.schema,i=l.value,n=l.errMsg,e=((t=r.children)===null||t===void 0?void 0:t.filter(function(d){var f;return(f=d.attribute)===null||f===void 0?void 0:f.exclusiveFillBlankInMatrix}))||[],a=JSON.parse(JSON.stringify(i));Object.values(a).forEach(function(d){e.map(function(f){return f.id}).forEach(function(f){delete d[f]})});var s=!1;if(r.type==="MatrixAuto")i&&i.length>0&&(s=!0);else{var o;s=(o=r.row)===null||o===void 0?void 0:o.every(function(d){var f=a[d.id];return!(0,M.xb)(f)})}return s?null:n}function E(l){var t=l.value,r=l.schema,i=l.isValid,n=l.errMsg;return!r||!r.parent?null:ge(t,r).map(function(e){var a=(0,ee.Z)(e,2),s=a[0],o=a[1];return i(o)?null:"".concat(s,"^").concat(n)}).filter(function(e){return e})[0]}function Ee(l){if(Object.keys(l).length===0)return!0}function Ve(l){var t=l.substring(6,8),r=l.substring(8,10),i=l.substring(10,12),n=new Date(parseFloat(t),parseFloat(r)-1,parseFloat(i));return!(n.getFullYear()-1900!==parseFloat(t)||n.getMonth()!==parseFloat(r)-1||n.getDate()!==parseFloat(i))}function be(l){var t=l;if(l.length!==15&&l.length!==18)return!1;if(l.length===15)return Ve(t);var r={11:"\u5317\u4EAC",12:"\u5929\u6D25",13:"\u6CB3\u5317",14:"\u5C71\u897F",15:"\u5185\u8499\u53E4",21:"\u8FBD\u5B81",22:"\u5409\u6797",23:"\u9ED1\u9F99\u6C5F ",31:"\u4E0A\u6D77",32:"\u6C5F\u82CF",33:"\u6D59\u6C5F",34:"\u5B89\u5FBD",35:"\u798F\u5EFA",36:"\u6C5F\u897F",37:"\u5C71\u4E1C",41:"\u6CB3\u5357",42:"\u6E56\u5317 ",43:"\u6E56\u5357",44:"\u5E7F\u4E1C",45:"\u5E7F\u897F",46:"\u6D77\u5357",50:"\u91CD\u5E86",51:"\u56DB\u5DDD",52:"\u8D35\u5DDE",53:"\u4E91\u5357",54:"\u897F\u85CF ",61:"\u9655\u897F",62:"\u7518\u8083",63:"\u9752\u6D77",64:"\u5B81\u590F",65:"\u65B0\u7586",71:"\u53F0\u6E7E",81:"\u9999\u6E2F",82:"\u6FB3\u95E8",91:"\u56FD\u5916 "},i=!0;if(!t||!/^([1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx])|([1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{2})$/i.test(t))i=!1;else if(!r[t.substr(0,2)])i=!1;else if(t.length>18)i=!1;else if(t.length===18){for(var n=t.split(""),e=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],a=[1,0,"X",9,8,7,6,5,4,3,2],s=0,o=0,d=0,f=0;f<17;f+=1)o=parseInt(n[f],10),d=e[f],s+=o*d;var v=n[17].toUpperCase()==="X"?"X":Number(n[17]);a[s%11]!==v&&(i=!1)}return i}function P(l,t){return!!(!l||!t||(0,M.xb)(l[t.id]))}var xe={required:function(t,r){var i,n=r.schema,e=r.theme;return r&&r.required===!1?null:(0,M.xb)(t)?e==="antdForm"?"\u8BF7\u8F93\u5165":"\u8FD9\u9053\u9898\u672A\u56DE\u7B54":n!=null&&(i=n.type)!==null&&i!==void 0&&i.startsWith("Matrix")?ye({schema:n,errMsg:"\u95EE\u9898\u672A\u56DE\u7B54\u5B8C\u6574",value:t}):n!=null&&n.parent?E({schema:n,value:t,errMsg:"\u8FD9\u4E2A\u9009\u9879\u672A\u56DE\u7B54",isValid:function(s){var o;return(0,ce.Kn)(n)&&(o=n.attribute)!==null&&o!==void 0&&o.dataType&&s===!0?!1:!(0,M.xb)(s)}}):null},answerLimit:function(t,r){var i,n=r.schema,e=n==null||(i=n.attribute)===null||i===void 0?void 0:i.answerLimit;if(!e)return null;var a=e.slice(1,e.length-1).split(","),s=parseInt(a[0]||"0"),o=parseInt(a[1]||"0"),d=Object.keys(t||{}).length;return t&&(d<s&&s!==0||d>o&&o!==0)?s===0?"\u6700\u591A\u9009\u62E9".concat(o,"\u9879"):o===0?"\u6700\u5C11\u9009\u62E9".concat(s,"\u9879"):"\u6700\u5C11\u9009\u62E9".concat(s,"\u9879,\u6700\u591A\u9009\u62E9").concat(o,"\u9879"):null},number:function(t,r){var i,n=r.schema;if(P(t,n))return null;var e=n==null||(i=n.attribute)===null||i===void 0?void 0:i.numericScale,a="\u8BF7\u8F93\u5165\u6570\u5B57";return e===0?a="\u8BF7\u8F93\u5165\u6574\u6570":e&&e>0&&(a="\u8BF7\u4FDD\u7559".concat(e,"\u4F4D\u5C0F\u6570")),E({errMsg:a,schema:n,value:t,isValid:function(o){return!(o!==void 0&&(!ne(o)||e===0&&!pe(o)||e!==void 0&&e>0&&("".concat(o).split(".")[1]||"").length>e))}})},date:function(t,r){var i,n=r.schema;if(P(t,n))return null;if(n!=null&&(i=n.attribute)!==null&&i!==void 0&&i.dateTimeFormat&&t&&t[n.id]){var e=ve()(t[n.id],n.attribute.dateTimeFormat).isValid();return e?null:"\u65E5\u671F\u683C\u5F0F\u4E0D\u6B63\u786E"}return N({errMsg:"\u8BF7\u8F93\u5165\u65E5\u671F",schema:n,regEx:/^(?:(?:1[6-9]|[2-9][0-9])[0-9]{2}([-/.]?)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:(?:1[6-9]|[2-9][0-9])(?:0[48]|[2468][048]|[13579][26])|(?:16|[2468][048]|[3579][26])00)([-/.]?)0?2\2(?:29))(\s+([01][0-9]:|2[0-3]:)?[0-5][0-9]:[0-5][0-9])?$/,value:t})},dateTime:function(t,r){var i=r.schema;return P(t,i)?null:N({errMsg:"\u8BF7\u8F93\u5165\u65E5\u671F\u65F6\u95F4",schema:i,regEx:/^\d{4}[-]([0][1-9]|(1[0-2]))[-]([1-9]|([012]\d)|(3[01]))\s(([0-1]{1}[0-9]{1})|([2]{1}[0-4]{1}))([:])(([0-5]{1}[0-9]{1}|[6]{1}[0]{1}))([:])((([0-5]{1}[0-9]{1}|[6]{1}[0]{1})))$/,value:t})},time:function(t,r){var i=r.schema;return P(t,i)?null:N({errMsg:"\u8BF7\u8F93\u5165\u65F6\u95F4",schema:i,regEx:/^(([0-1]{1}[0-9]{1})|([2]{1}[0-4]{1}))([:])(([0-5]{1}[0-9]{1}|[6]{1}[0]{1}))([:])((([0-5]{1}[0-9]{1}|[6]{1}[0]{1})))$/,value:t})},mobile:function(t,r){var i=r.schema;return P(t,i)?null:N({errMsg:"\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E",schema:i,regEx:/^1([3578][0-9]|4[579]|66|7[01235678]|9[1289])[0-9]{8}$/,value:t})},decimal:function(t,r){var i=r.schema;return P(t,i)?null:N({errMsg:"\u8BF7\u8F93\u5165\u6570\u5B57",schema:i,regEx:/^[+-]?\d+(\.\d+)?$/,value:t})},email:function(t,r){var i=r.schema;return P(t,i)?null:N({errMsg:"\u90AE\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E",schema:i,regEx:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,value:t})},idCard:function(t,r){var i=r.schema;return P(t,i)?null:E({errMsg:"\u8EAB\u4EFD\u8BC1\u683C\u5F0F\u4E0D\u6B63\u786E",schema:i,value:t,isValid:function(e){return!(e&&!be("".concat(e)))}})},chinese:function(t,r){var i=r.schema;return P(t,i)?null:N({errMsg:"\u8BF7\u8F93\u5165\u6C49\u5B57",schema:i,regEx:/^[\u4e00-\u9fa5]+$/,value:t})},alphabet:function(t,r){var i=r.schema;return P(t,i)?null:N({errMsg:"\u8BF7\u8F93\u5165\u5B57\u6BCD",schema:i,regEx:/^[a-zA-Z]+$/,value:t})},textLimit:function(t,r){var i,n=r.schema;if(P(t,n))return null;var e=n==null||(i=n.attribute)===null||i===void 0?void 0:i.textLimit;if(!e)return null;var a=e.slice(1,e.length-1).split(","),s=parseInt(a[0]||"0"),o=parseInt(a[1]||"0");if(s===0&&o===0)return null;var d=E({errMsg:s!==o?"\u8BF7\u8F93\u5165".concat(s,"~").concat(o,"\u4E2A\u5B57"):"\u8BF7\u8F93\u5165".concat(s,"\u4E2A\u5B57"),schema:n,value:t,isValid:function(v){return!(v&&("".concat(v).length<s||"".concat(v).length>o))}});return d},scope:function(t,r){var i,n,e=r.schema,a=e==null||(i=e.attribute)===null||i===void 0?void 0:i.scope,s=e==null||(n=e.attribute)===null||n===void 0?void 0:n.dataType;if(a&&s){if(s==="number")return E({errMsg:"\u6570\u503C\u8303\u56F4\u4E0D\u6B63\u786E ".concat(a),schema:e,value:t,isValid:function(d){return!(d&&!(0,X.$l)(a,"".concat(d)))}});if(s==="date")return E({errMsg:"\u65E5\u671F\u8303\u56F4\u4E0D\u6B63\u786E ".concat(a),schema:e,value:t,isValid:function(d){return!(d&&!(0,X.sm)(a,"".concat(d)))}});if(s==="dateTime")return E({errMsg:"\u65E5\u671F\u65F6\u95F4\u8303\u56F4\u4E0D\u6B63\u786E ".concat(a),schema:e,value:t,isValid:function(d){return!(d&&!(0,X.de)(a,"".concat(d)))}});if(s==="time")return E({errMsg:"\u65F6\u95F4\u8303\u56F4\u4E0D\u6B63\u786E ".concat(a),schema:e,value:t,isValid:function(d){return!(d&&!(0,X.YM)(a,"".concat(d)))}})}return null},horzBlank:function(t,r){return(0,Z.Z)((0,F.Z)().mark(function i(){var n,e,a,s,o,d,f,v;return(0,F.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(e=r.schema,!((e==null||(n=e.attribute)===null||n===void 0?void 0:n.dataType)!=="horzBlank"||t[e.id]===void 0||!e.children||!e.parent)){h.next=3;break}return h.abrupt("return",null);case 3:a=null,s=0;case 5:if(!(s<((o=e.children)===null||o===void 0?void 0:o.length))){h.next=15;break}return d=e.children[s],f=(0,me.j)(d,e),h.next=10,(0,te.Gu)(t[e.id],f,{validateFirst:!0});case 10:v=h.sent,v.error&&v.error.length>0&&(a=v.error[0]);case 12:s++,h.next=5;break;case 15:return h.abrupt("return",a);case 16:case"end":return h.stop()}},i)}))()}};(0,te.au)(xe);var Me=u(8166),ie=u(8373),T=u(85893);window.katex=Me.Z;var re=(0,V.forwardRef)(function(l,t){var r=l.theme,i=r===void 0?K.uH:r,n=l.footerVisible,e=n===void 0?!0:n,a=l.headerVisible,s=a===void 0?!0:a,o=l.loading,d=l.questionNumber,f=d===void 0?!0:d,v=l.onUpload,p=l.progressBar,h=p===void 0?!1:p,y=l.statistics,m=l.isPreview,c=l.mode,x=c===void 0?"survey":c,$=l.correctAnswerVisible,O=$===void 0?!1:$,A=l.examScoreVisible,R=A===void 0?!1:A,J=l.requiredVisible,z=J===void 0?!0:J,Q=l.onDictSearch,_=(0,V.useMemo)(function(){return new de(l)},[]),C=_.form,j=(0,V.useMemo)(function(){return(0,M.Gt)(l.schema)},[l.schema]),Pe=(0,V.useMemo)(function(){var S={},B=function W(w){S[w.id]=w.title,w.children&&w.children.forEach(W)};return B(j),document.title=(0,q.WO)(j.title),S},[j]),Ze=(0,V.useMemo)(function(){return(0,M.R6)(l.schema)},[l.schema]);(0,V.useImperativeHandle)(t,function(){return{submit:function(){return _.submit()},reset:function(){C.reset()},setValues:function(B){C.setValues(B,"overwrite")},setValue:function(B,W){C.setFieldState(B,function(w){return w.value=W})},toggleReadOnly:function(B){C.setState(function(W){W.pattern=B?"readPretty":"editable"})},getValues:function(){return C.values}}}),(0,V.useEffect)(function(){l.onInit&&l.onInit(C)},[]);var Oe=(0,V.useMemo)(function(){return{theme:i,schema:j,footerVisible:e,questionNumber:f,headerVisible:s,optionTypes:Ze,onUpload:v,loading:o,id2title:Pe,progressBar:h,innerStore:_,statistics:y,isPreview:m,mode:x,correctAnswerVisible:O,examScoreVisible:R,onDictSearch:Q,requiredVisible:z}},[o,j,y]);return(0,T.jsx)(V.Suspense,{fallback:(0,T.jsx)(ie.gb,{}),children:(0,T.jsx)(ie.ZP,{theme:i,children:(0,T.jsx)(L.RV,{form:C,children:(0,T.jsx)(H.Z.Provider,{value:Oe,children:(0,T.jsx)(G.k9,{schema:j})})})})})}),Fe=re},8373:function(ae,U,u){"use strict";u.d(U,{gb:function(){return Y}});var L=u(67294),V=u(85893),G=L.lazy(function(){return Promise.all([u.e(7291),u.e(4409),u.e(8369),u.e(7422),u.e(3136),u.e(2804),u.e(4535),u.e(8550),u.e(5990),u.e(5724),u.e(7511),u.e(8867),u.e(7856),u.e(1044),u.e(2595),u.e(6389),u.e(5811)]).then(u.bind(u,46033))}),H=L.lazy(function(){return Promise.all([u.e(9548),u.e(7291),u.e(4409),u.e(4177),u.e(8369),u.e(6779),u.e(7422),u.e(1257),u.e(3136),u.e(2804),u.e(3710),u.e(8550),u.e(5990),u.e(5724),u.e(2684),u.e(8867),u.e(7856),u.e(6625),u.e(1044),u.e(596),u.e(811),u.e(6389),u.e(8463)]).then(u.bind(u,68209))}),K=L.lazy(function(){return Promise.all([u.e(4409),u.e(1257),u.e(4535),u.e(5990),u.e(7856),u.e(1044),u.e(4499),u.e(9389)]).then(u.bind(u,17707))}),Y=function(){return(0,V.jsx)("div",{className:"page-loading-warp",children:(0,V.jsxs)("div",{className:"spinner",children:[(0,V.jsx)("div",{className:"rect1"}),(0,V.jsx)("div",{className:"rect2"}),(0,V.jsx)("div",{className:"rect3"}),(0,V.jsx)("div",{className:"rect4"}),(0,V.jsx)("div",{className:"rect5"})]})})},k=function(D){var Z=D.theme,b=D.children;return Z==="antdMobile"?(0,V.jsx)(H,{children:b}):Z==="antdForm"?(0,V.jsx)(K,{children:b}):(0,V.jsx)(G,{children:b})};U.ZP=k}}]);
