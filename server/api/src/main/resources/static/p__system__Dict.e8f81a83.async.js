(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[8270],{25855:function(Y,w,t){"use strict";t.r(w),t.d(w,{default:function(){return X}});var q=t(57663),B=t(71577),y=t(39428),R=t(3182),_=t(71194),k=t(50146),D=t(94657),m=t(3980),K=t(57119),$=t(49101),A=t(87859),P=t(91186),E=t(80582),Z=t(67294),v=t(11849),V=t(96389),ee=t(34792),b=t(48086),te=t(43185),z=t(32620),G=t(90631),L=t(84391),N=t(43347),e=t(85893),U=z.Z.Dragger;function M(o){var h=o.current,p=o.onCancel,n=o.onOk,d=(0,Z.useState)(!1),x=(0,D.Z)(d,2),s=x[0],u=x[1],c=(0,Z.useState)([]),i=(0,D.Z)(c,2),C=i[0],r=i[1],j={multiple:!1,accept:".xlsx",beforeUpload:function(a){return r([a]),!1},onRemove:function(){r([])},maxCount:1};return(0,e.jsx)(k.Z,{title:"Excel\u6A21\u677F\u5BFC\u5165\u5B57\u5178\u9879",onCancel:p,open:!0,maskClosable:!1,footer:[(0,e.jsx)(B.Z,{onClick:p,children:"\u53D6\u6D88"},"cancel"),(0,e.jsx)(B.Z,{icon:(0,e.jsx)(G.Z,{}),onClick:function(){m.hi.download("/api/file/downloadTemplate?name=\u5B57\u5178\u5BFC\u5165\u6A21\u677F")},children:"\u4E0B\u8F7D\u6A21\u677F"},"downloadTemplate"),(0,e.jsx)(B.Z,{icon:(0,e.jsx)(L.Z,{}),type:"primary",loading:s,onClick:function(){if(C.length===0){b.default.error("\u8BF7\u9009\u62E9\u6587\u4EF6");return}u(!0),m.hi.importDictItems({file:C[0],dictCode:h.code}).then(function(a){u(!1),a.success?(b.default.success("\u5BFC\u5165\u6210\u529F"),n()):b.default.error(a.message)})},children:"\u5BFC\u5165"},"importTemplate")],children:(0,e.jsxs)(U,(0,v.Z)((0,v.Z)({},j),{},{children:[(0,e.jsx)("p",{className:"ant-upload-drag-icon",children:(0,e.jsx)(N.Z,{})}),(0,e.jsx)("p",{className:"ant-upload-text",children:"\u70B9\u51FB\u6216\u8005\u62D6\u62FDExcel\u6587\u4EF6\u5230\u6B64\u5904"})]}))})}var J=(0,E.Pi)(function(o){var h=o.dict,p=o.onClose,n=(0,Z.useRef)(),d=(0,Z.useState)([]),x=(0,D.Z)(d,2),s=x[0],u=x[1],c=(0,Z.useState)(!1),i=(0,D.Z)(c,2),C=i[0],r=i[1],j=[{title:"\u5B57\u5178\u9879\u540D\u79F0",dataIndex:"itemName",formItemProps:function(a,f){var g=f.rowIndex;return{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}}},{title:"\u5B57\u5178\u9879\u503C",dataIndex:"itemValue",formItemProps:function(a,f){var g=f.rowIndex;return{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}}},{title:"\u7236\u5B57\u5178\u9879\u503C",dataIndex:"parentItemValue"},{title:"\u5C42\u7EA7",dataIndex:"itemLevel",valueType:"digit"},{title:"\u987A\u5E8F",dataIndex:"itemOrder",valueType:"digit",tooltip:"\u6570\u5B57\u8D8A\u5C0F\uFF0C\u4F18\u5148\u7EA7\u8D8A\u9AD8"},{title:"\u64CD\u4F5C",valueType:"option",render:function(a,f,g,F){return[(0,e.jsx)("a",{onClick:function(){var O;F==null||(O=F.startEditable)===null||O===void 0||O.call(F,f.id)},children:"\u7F16\u8F91"},"editable")]}}];return(0,e.jsxs)(k.Z,{open:!0,title:!1,onCancel:p,footer:!1,width:800,maskClosable:!1,children:[(0,e.jsx)(P.nx,{columns:j,actionRef:n,bordered:!0,request:function(){var l=(0,R.Z)((0,y.Z)().mark(function a(f){var g;return(0,y.Z)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,m.hi.loadDictItems((0,v.Z)((0,v.Z)({},f),{},{dictCode:h.code}));case 2:return g=I.sent,I.abrupt("return",{success:!0,data:g.list,total:g.total});case 4:case"end":return I.stop()}},a)}));return function(a){return l.apply(this,arguments)}}(),columnsState:{persistenceKey:"system-dictItem",persistenceType:"localStorage"},rowKey:"id",pagination:{pageSize:100},recordCreatorProps:{record:function(){return{id:(0,V.kb)(8)}}},editable:{type:"multiple",editableKeys:s,onSave:function(){var l=(0,R.Z)((0,y.Z)().mark(function f(g,F,I){return(0,y.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",m.hi.saveOrUpdateDictItem((0,v.Z)((0,v.Z)({},F),{},{dictCode:h.code})));case 1:case"end":return T.stop()}},f)}));function a(f,g,F){return l.apply(this,arguments)}return a}(),onDelete:function(a,f){return m.hi.deleteDictItem(a)},onChange:u},dateFormatter:"string",headerTitle:"\u5B57\u5178\u5217\u8868",toolBarRender:function(){return[(0,e.jsx)(B.Z,{icon:(0,e.jsx)($.Z,{}),type:"primary",onClick:function(){return r(!0)},children:"\u5BFC\u5165"},"button")]}}),C&&(0,e.jsx)(M,{current:h,onCancel:function(){return r(!1)},onOk:function(){var a;r(!1),(a=n.current)===null||a===void 0||a.reload()}})]})}),W=J,S=t(82837),H=(0,E.Pi)(function(o){var h=o.onOk,p=o.onClose,n=o.dict,d=(0,Z.useRef)(),x=!!(n!=null&&n.id);return(0,e.jsxs)(S.aN,{title:x?"\u4FEE\u6539\u5B57\u5178":"\u65B0\u589E\u5B57\u5178",formRef:d,visible:!0,initialValues:n,drawerProps:{forceRender:!0,destroyOnClose:!0,onClose:function(){p()}},onFinish:function(){var s=(0,R.Z)((0,y.Z)().mark(function u(c){var i;return(0,y.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n!=null&&n.id)){r.next=6;break}return r.next=3,m.hi.updateDict((0,v.Z)((0,v.Z)({},n),c));case 3:i=r.sent,r.next=9;break;case 6:return r.next=8,m.hi.saveDict((0,v.Z)((0,v.Z)({},n),c));case 8:i=r.sent;case 9:i.success&&h();case 10:case"end":return r.stop()}},u)}));return function(u){return s.apply(this,arguments)}}(),children:[(0,e.jsxs)(S.ZP.Group,{children:[(0,e.jsx)(S.V,{name:"name",width:"md",label:"\u5B57\u5178\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u5B57\u5178\u540D\u79F0",required:!0,rules:[{required:!0,message:"\u5B57\u5178\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,e.jsx)(S.V,{width:"md",name:"code",label:"\u5B57\u5178\u7F16\u7801",placeholder:"\u8BF7\u8F93\u5165\u5B57\u5178\u7F16\u7801",rules:[{required:!0,message:"\u5B57\u5178\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"}],required:!0})]}),(0,e.jsx)(S.ZP.Group,{children:(0,e.jsx)(S.$J,{name:"remark",width:"xl",label:"\u63CF\u8FF0",placeholder:"\u8BF7\u8F93\u5165\u5B57\u5178\u63CF\u8FF0\u4FE1\u606F"})})]})}),Q=(0,E.Pi)(function(){var o=(0,Z.useRef)(),h=(0,Z.useState)(),p=(0,D.Z)(h,2),n=p[0],d=p[1],x=[{title:"\u5B57\u5178\u540D\u79F0",dataIndex:"name",ellipsis:!0},{title:"\u5B57\u5178\u7F16\u7801",dataIndex:"code",hideInSearch:!0},{title:"\u63CF\u8FF0",dataIndex:"remark",search:!1},{title:"\u521B\u5EFA\u65F6\u95F4",key:"showTime",dataIndex:"createAt",valueType:"dateTime",hideInSearch:!0,width:200},{title:"\u64CD\u4F5C",valueType:"option",width:200,render:function(u,c){return[(0,e.jsx)("a",{onClick:function(){d({visible:!0,current:c,type:"dictItem"})},children:"\u5B57\u5178\u9879"},"readonly"),(0,e.jsx)(P.zI,{onSelect:function(C){C==="edit"&&d({current:c,visible:!0,type:"dict"}),C==="delete"&&k.Z.confirm({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u5B57\u5178?",icon:(0,e.jsx)(K.Z,{}),onOk:function(){m.hi.deleteDict(c.id).then(function(){var j;(j=o.current)===null||j===void 0||j.reload()})}})},menus:[{key:"edit",name:"\u7F16\u8F91"},{key:"delete",name:"\u5220\u9664"}]},"actionGroup")]}}];return(0,e.jsxs)(A._z,{title:!1,children:[(0,e.jsx)(P.ZP,{columns:x,bordered:!0,actionRef:o,request:function(){var s=(0,R.Z)((0,y.Z)().mark(function u(c){var i;return(0,y.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,m.hi.loadDicts(c);case 2:return i=r.sent,r.abrupt("return",{success:!0,data:i.list,total:i.total});case 4:case"end":return r.stop()}},u)}));return function(u){return s.apply(this,arguments)}}(),scroll:{x:800},columnsState:{persistenceKey:"system-dict",persistenceType:"localStorage"},rowKey:"id",search:{labelWidth:"auto"},pagination:{pageSize:5},dateFormatter:"string",headerTitle:"\u5B57\u5178\u5217\u8868",toolBarRender:function(){return[(0,e.jsx)(B.Z,{icon:(0,e.jsx)($.Z,{}),type:"primary",onClick:function(){d({visible:!0,type:"dict"})},children:"\u65B0\u5EFA"},"button")]}}),(n==null?void 0:n.visible)&&n.type==="dict"&&(0,e.jsx)(H,{onClose:function(){d(void 0)},onOk:function(){var u;d(void 0),(u=o.current)===null||u===void 0||u.reload()},dict:n.current}),(n==null?void 0:n.current)&&n.type==="dictItem"&&(0,e.jsx)(W,{onClose:function(){d(void 0)},dict:n.current})]})}),X=Q}}]);
